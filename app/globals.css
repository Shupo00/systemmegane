:root { color-scheme: light dark; }
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans JP, sans-serif;
  background: var(--bg);
  color: var(--fg);
  overflow-x: hidden; /* allow full-bleed sections without horizontal scroll */
}

h1, h2, h3, .heading-serif { font-family: var(--font-serif), 'Noto Serif JP', Georgia, 'Times New Roman', serif; letter-spacing: .3px; }

/* Theme tokens */
:root {
  /* Off-white luxurious palette */
  --bg: #f7f6f2;          /* off-white base */
  --surface: #ffffff;      /* cards */
  --surface-2: #f2efe7;    /* inputs */
  --fg: #2d2f33;           /* primary text */
  --muted: #6e737b;        /* secondary text */
  --border: #e6e1d5;       /* soft border */
  --accent: #d4a017;       /* warm gold */
  --accent-2: #ffe7a3;     /* pale gold */
  --ok: #2e7d32;
  --err: #d84343;
  --shadow: 0 12px 36px rgba(0,0,0,.12);
}

.container { max-width: 1200px; margin: 0 auto; padding: 1rem; }
header { display: flex; justify-content: space-between; align-items: center; padding: .75rem 0; }
header h1 { font-size: 1.1rem; margin: 0; letter-spacing: .2px; }
header nav a { color: var(--muted); text-decoration: none; margin-left: .5rem; transition: color .15s ease; }
header nav a:hover { color: #5a5e66; }

main { padding: 1rem 0 2.5rem; }

input, textarea, button, select { font: inherit; }
.input, input[type="text"], input[type="search"], input[type="email"], input[type="password"], input[type="date"], textarea, select {
  width: 100%;
  padding: .7rem .85rem;
  border-radius: .7rem;
  border: 1px solid var(--border);
  background: var(--surface-2);
  color: var(--fg);
  outline: none;
}
.input:focus, input:focus, textarea:focus, select:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(212,160,23,.18); }

.btn { appearance: none; border: 1px solid var(--border); background: var(--surface-2); color: var(--fg); padding: .65rem 1rem; border-radius: .9rem; cursor: pointer; transition: background .15s ease, border-color .15s ease, transform .06s ease, box-shadow .15s ease; }
.btn:hover { background: var(--surface); border-color: #d9d3c4; box-shadow: 0 6px 18px rgba(0,0,0,.08); }
.btn:active { transform: translateY(1px); }
.btn.primary { background: linear-gradient(180deg, var(--accent-2), var(--accent)); border: 1px solid #c79a16; color: #2d2305; }
.btn.ghost { background: transparent; border-color: var(--border); }
.btn.warn { background: #2a1616; border-color: #3a1e1e; color: #ffb4b4; }
.btn.small { padding: .45rem .7rem; border-radius: .7rem; font-size: .95rem; }
.btn:disabled { opacity: .6; cursor: not-allowed; box-shadow: none; transform: none; }

.row { display: flex; gap: .75rem; flex-wrap: wrap; align-items: center; }
.stack { display: grid; gap: .75rem; }

.card { border: 1px solid var(--border); border-radius: 1rem; padding: 1.1rem; background: linear-gradient(180deg, #ffffff, #fbfaf7); box-shadow: var(--shadow); }
.card h2, .card h3 { margin: .1rem 0 .6rem; }
.muted { color: var(--muted); }

.grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; }
.lock { opacity: .85; filter: grayscale(10%); }

.badge { display: inline-block; padding: .2rem .5rem; border-radius: 999px; font-size: .73rem; line-height: 1; vertical-align: middle; margin-left: .4rem; border: 1px solid transparent; }
.badge.ai { color: #3b2a00; background: #ffefc4; border-color: #e4c46a; }
.badge.mock { color: #41214b; background: #f1d6ff; border-color: #e0b7ff; }

.avatar { width: 64px; height: 64px; border-radius: 50%; object-fit: cover; background: #fff; border: 2px solid #ede7da; box-shadow: 0 1px 2px rgba(0,0,0,.08) inset; }
.character-head { display: flex; align-items: center; gap: 1rem; }

/* DayPicker tuning */
.rdp { --rdp-accent-color: var(--accent); --rdp-background-color: var(--surface-2); color: var(--fg); }
.rdp-months { background: #fff; border: 1px solid var(--border); border-radius: 1rem; padding: .5rem; box-shadow: var(--shadow); }
.rdp-day_selected, .rdp-day_selected:focus-visible, .rdp-day_selected:hover { background: var(--accent); color: #0b1424; }
.rdp-day_today { color: #b08900; font-weight: 700; }

/* Modal */
.modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.28); backdrop-filter: blur(2px); display: grid; place-items: center; z-index: 50; }
.modal-window { width: min(860px, calc(100vw - 32px)); max-height: calc(100vh - 120px); overflow: auto; background: linear-gradient(180deg, #ffffff, #fbfaf7); border: 1px solid var(--border); border-radius: 14px; box-shadow: 0 24px 60px rgba(0,0,0,.18); }
.modal-header { padding: 1rem 1.2rem .5rem; border-bottom: 1px solid var(--border); }
.modal-body { padding: 1.2rem; }
.modal-actions { padding: .8rem 1.2rem 1.2rem; display: flex; gap: .6rem; justify-content: flex-end; }

/* Quad grid for daily entries */
.quad-grid { display: grid; grid-template-columns: repeat(2, 1fr); grid-template-rows: auto auto; gap: 1rem; }
.stack-col { display: grid; gap: .6rem; align-content: start; }
.entry-card { border: 1px solid var(--border); border-radius: .9rem; background: #fff; padding: .8rem; }
.entry-meta { color: var(--muted); font-size: .9rem; margin-bottom: .25rem; }

@media (max-width: 900px) {
  .quad-grid { grid-template-columns: 1fr; grid-template-rows: auto; }
}

/* Full-page calendar layout (single month, centered, large cells) */
.calendar-full {
  min-height: calc(100vh - 140px);
  display: grid;
  align-items: start;
  /* full-bleed */
  width: 100vw;
  margin-left: calc(50% - 50vw);
  padding-left: max(24px, env(safe-area-inset-left));
  padding-right: max(24px, env(safe-area-inset-right));
}
.calendar-full .rdp { --rdp-cell-size: 112px; --rdp-font-size: 1.2rem; padding: .5rem; }
.calendar-full .rdp-months { margin: 0 auto; width: fit-content; }

@media (max-width: 900px) {
  .calendar-full .rdp { --rdp-cell-size: 72px; }
}
@media (max-width: 640px) {
  .calendar-full .rdp { --rdp-cell-size: 56px; }
}

/* Rich interactions and typography for calendar */
.rdp-caption_label { font-size: 2rem; font-weight: 700; letter-spacing: .2px; color: #433e2f; }
.rdp-caption { padding: .6rem 1rem; }
.rdp-nav { gap: .25rem; }
.rdp-head_cell { color: #8a8e96; font-weight: 600; }
.rdp-day { border-radius: 12px; transition: transform .08s ease, box-shadow .15s ease, background .15s ease; }
.rdp-day:hover { background: #fff7e0; box-shadow: 0 6px 16px rgba(0,0,0,.06); transform: translateY(-1px); }
.rdp-day_selected, .rdp-day_selected:focus-visible, .rdp-day_selected:hover { background: linear-gradient(180deg, #ffefc4, #e7c35a); color: #2d2305; box-shadow: 0 6px 18px rgba(212,160,23,.25); }
.rdp-nav_button { color: #6e737b; border-radius: 10px; }
.rdp-nav_button:hover { background: #fff3cd; color: #2d2305; }
.rdp-hascount { background: #fff8e6 !important; }
:root { color-scheme: light dark; }
/* Tighten calendar card spacing and center content */
.card.calendar-full { padding: 1rem 0 1rem; border-radius: .9rem; }
.stack-tight { display: grid; gap: .35rem; }
.calendar-full { min-height: auto; display: grid; place-items: center; width: 100%; padding: 0; }
.calendar-full .rdp-months { padding: .8rem 1rem; margin: 0 auto; }
/* Hide calendar title on home, keep a clean hero look */
.calendar-full h2 { display: none; }
/* Add a little space under the Today button */
.calendar-full .btn.primary { margin-bottom: .6rem; }
/* Two-column layout for composer + entries */
.two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; align-items: start; }
@media (max-width: 900px) { .two-col { grid-template-columns: 1fr; } }

/* Precise layout: composer fixed width (left), entries fill (right) */
.day-layout { display: flex; gap: 1.2rem; align-items: flex-start; }
.composer-card { width: 420px; max-width: 100%; flex: 0 0 auto; }
.entries-card { flex: 1 1 auto; min-width: 0; }
/* Stack earlier to avoid tiny right column on mid widths */
@media (max-width: 1280px) {
  .day-layout { flex-direction: column; }
  .composer-card { width: 100%; }
}
/* If template classes are not present, enforce widths by position */
.day-layout > .card:first-child { width: 420px; max-width: 100%; flex: 0 0 auto; }
.day-layout > .card:nth-child(2) { flex: 1 1 auto; min-width: 0; }
/* Robust targeting: by content */
.day-layout .card:has(textarea) { width: 420px; max-width: 100%; flex: 0 0 auto; }
.day-layout .card:has(.quad-grid) { flex: 1 1 auto; min-width: 0; }
/* Ensure entries wrapper looks like a card even if markup varies */
.day-layout :is(.entries-card, .card:has(.quad-grid)) {
  border: 1px solid var(--border);
  border-radius: 1rem;
  background: linear-gradient(180deg, #ffffff, #fbfaf7);
  box-shadow: var(--shadow);
  padding: 1rem;
}

/* Day page root grid: single column to keep cohesion */
.day-grid { display: grid; grid-template-columns: 1fr; gap: 1rem; }
/* Temporarily hide entries section */
/* show entries card (previously hidden for layout experiments) */
@media (max-width: 1100px) {
  .day-layout { flex-direction: column; }
  .composer-card { width: 100%; }
}
