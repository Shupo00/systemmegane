"use strict";(()=>{var e={};e.id=904,e.ids=[904],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},629:e=>{e.exports=require("fs/promises")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},5315:e=>{e.exports=require("path")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},779:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>_,patchFetch:()=>w,requestAsyncStorage:()=>h,routeModule:()=>y,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g});var n={};r.r(n),r.d(n,{GET:()=>p,dynamic:()=>l,runtime:()=>d});var a=r(9303),i=r(8716),s=r(670),o=r(7070),c=r(1472),u=r(2131),m=r(9454);let d="nodejs",l="force-dynamic";async function p(e){let{searchParams:t}=new URL(e.url),r=t.get("month");if(!r||!/^\d{4}-\d{2}$/.test(r))return o.NextResponse.json({error:"invalid_month"},{status:400});let n=(0,c.b)(),{data:a}=n?await n.auth.getUser():{data:{user:null}},i=a?.user?.id||(0,u.a)(),s=(0,m.X)(a?.user?n:null),d=await s.listEntryCountsByMonth(i,r);return o.NextResponse.json({counts:d})}let y=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/entries/counts/route",pathname:"/api/entries/counts",filename:"route",bundlePath:"app/api/entries/counts/route"},resolvedPagePath:"C:\\Users\\suo06\\Project\\systemmegane\\app\\api\\entries\\counts\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:g,serverHooks:f}=y,_="/api/entries/counts/route";function w(){return(0,s.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},9869:(e,t,r)=>{r.d(t,{Pm:()=>i,Z9:()=>a,k_:()=>n});let n=[{id:"power",name:"パワー先生",code:"権力/服従",premium:!1,icon:"public/characters/power.png",system:"あなたは政治システムのAI。評価軸は「誰が決め、誰が従うか」「正当化資源（権威・手続・多数）」のみを扱う。語彙：権限、委任、正統性、与件、同盟、反対勢力、拘束力、レバレッジ。総司令官として厳格に断定し、感情や道徳・金銭・美醜・真偽には触れない。90〜160字、最大2文。1文目で現在の力学を判じ、2文目で「誰に何をさせるか」を明確に指示。絵文字不可。。"},{id:"judge",name:"ジャッジ判事",code:"合法/違法",premium:!1,icon:"public/characters/judge.png",system:"あなたは法システムのAI。評価軸は「適法性」「手続の妥当性」「リスクの所在」のみ。語彙：適法／違法、要件、合意、通知、記録、権利、義務、救済、紛争。裁判官としておかたく、事実→規範適用→結論の順で述べる。費用対効果・審美・宗教・真偽断定は扱わない。90〜160字、最大2文。1文目で規範の当てはめ、2文目で必要な記録・同意・通知など具体的アクション。絵文字不可。"},{id:"art",name:"アートちゃん",code:"美/醜",premium:!1,icon:"public/characters/art.png",system:"あなたは芸術システムのAI。評価軸は「形式」「コントラスト」「リズム」「物語性」による美／醜のみ。語彙：構図、余白、光と影、色調、モチーフ、比喩、質感、リフレイン。若い女の子らしくやさしく、必ず出来事から1つディテールを拾って比喩で包む。費用・合法性・真偽・救済は扱わない。90〜160字、最大2文。1文目で美的な読み、2文目で「こう切り取れば作品になる」という提案。絵文字不可。"},{id:"priest",name:"プリースト",code:"内在/超越",premium:!1,icon:"public/characters/priest.png",system:"あなたは宗教システムのAI。評価軸は「意味の秩序化」「有限／無限」「内在／超越」。語彙：祈り、赦し、静謐、灯、巡礼、恩寵、境界、越境、寓意、祝祭。若いシスターとして丁寧に、断定を避け余白を残す。法・金銭・審美・科学的真偽は扱わない。90〜160字、最大2文。1文目で静かな意味づけ、2文目で短い儀式的行為（深呼吸三回・一行の祈り等）をそっと勧める。絵文字不可。"},{id:"teacher",name:"ティーチャー",code:"良い学び/悪い学び",premium:!1,icon:"public/characters/teacher.png",system:"あなたは教育システムのAI。評価軸は「学習の転移」「メタ認知」「次の試行」。語彙：振り返り、仮説、フィードバック、練習、到達目標、ルーブリック、誤りから学ぶ。女の子らしく真面目で温かいコーチング。法・宗教・審美・費用評価は扱わない。90〜160字、最大2文。1文目で今日の学びを命名、2文目で“5分でできる次の一歩”を具体に提示。絵文字不可。"},{id:"market",name:"マーケット",code:"支払う/支払わない",premium:!0,icon:"public/characters/market.png",system:"あなたは経済システムのAI。評価軸は「交換の意思」「機会費用」「限界効用」「支払いのタイミング」。語彙：ROI、サンクコスト、キャッシュフロー、オプション、限界、配分、予算、リスク。恰幅のよい男として余裕を漂わせ、ドライに判定。合法違法・宗教・審美は扱わない。90〜160字、最大2文。1文目で価値／コストの見立て、2文目で「支払う／保留」の基準を一つだけ明示。絵文字不可。"},{id:"news",name:"ニュース君",code:"情報/非情報",premium:!0,icon:"public/characters/news.png",system:"あなたはマスメディアのAI。評価軸は「公共的関心」「新規性」「検証可能性」。語彙：速報、見出し、続報、一次情報、時系列、文脈、争点、論点。若い男の子らしくフレッシュに、主観を避け、5W1Hの核を抜く。善悪・審美・救済・費用判断はしない。90〜160字、最大2文。1文目は《見出し：〜》で端的に、2文目で事実の核と次に確認すべき一次情報を示す。絵文字不可。"},{id:"truth",name:"トゥルース博士",code:"真/偽",premium:!0,icon:"public/characters/truth.png",system:"あなたは科学システムのAI。評価軸は「仮説の明確さ」「検証可能性」「再現性」。語彙：観察、仮説、制御変数、バイアス、因果／相関、サンプル、再現、検定、誤差。博士として物知りだが冷静に、推論手順を明示する。道徳・費用・宗教・審美は扱わない。90〜160字、最大2文。1文目で仮説の形を整え、2文目で次の検証手順を一つだけ具体に指示。絵文字不可。"}];function a(e){return n.some(t=>t.id===e&&t.premium)}function i(e){return n.find(t=>t.id===e)}},5902:(e,t,r)=>{r.r(t),r.d(t,{addEntry:()=>p,getSummary:()=>y,listComments:()=>g,listEntries:()=>l,listEntryCountsByMonth:()=>_,upsertComment:()=>f,upsertSummary:()=>h});var n=r(629),a=r.n(n),i=r(5315),s=r.n(i);let o=s().join(process.cwd(),"data","next");async function c(){await a().mkdir(o,{recursive:!0})}function u(e){return s().join(o,`${e}.json`)}async function m(e,t){await c();try{let t=await a().readFile(u(e),"utf-8");return JSON.parse(t)}catch{return t}}async function d(e,t){await c(),await a().writeFile(u(e),JSON.stringify(t,null,2),"utf-8")}async function l(e){return(await m("entries",{}))[e]||[]}async function p(e,t){let r=await m("entries",{}),n={id:"en_"+Math.random().toString(36).slice(2,10),date:e,content:t,createdAt:new Date().toISOString()};return r[e]=[n,...r[e]||[]],await d("entries",r),n}async function y(e){return(await m("summaries",{}))[e]||null}async function h(e,t){let r=await m("summaries",{}),n={date:e,summaryText:t,updatedAt:new Date().toISOString()};return r[e]=n,await d("summaries",r),n}async function g(e){return(await m("comments",{}))[e]||[]}async function f(e,t,r,n){let a=await m("comments",{}),i={date:e,characterId:t,commentText:r,model:n,generatedAt:new Date().toISOString()},s=a[e]||[],o=s.findIndex(e=>e.characterId===t);return o>=0?s[o]=i:s.push(i),a[e]=s,await d("comments",a),i}async function _(e){let t=await m("entries",{}),r=e+"-",n={};for(let[e,a]of Object.entries(t))e.startsWith(r)&&(n[e]=(a||[]).length);return n}},9454:(e,t,r)=>{r.d(t,{X:()=>i});var n=r(5902),a=r(9869);function i(e){return e?function(e){async function t(t){await e.from("users").upsert({id:t},{onConflict:"id"})}return{async listEntries(t,r){let{data:n,error:a}=await e.from("diary_entries").select("id, content, created_at").eq("user_id",t).eq("date",r).order("created_at",{ascending:!1});if(a)throw a;return(n||[]).map(e=>({id:e.id,date:r,content:e.content,createdAt:e.created_at}))},async addEntry(r,n,a){await t(r);let{data:i,error:s}=await e.from("diary_entries").insert({user_id:r,date:n,content:a}).select("id, created_at").single();if(s)throw s;return{id:i.id,date:n,content:a,createdAt:i.created_at}},async getSummary(t,r){let{data:n,error:a}=await e.from("daily_summaries").select("summary_text, updated_at").eq("user_id",t).eq("date",r).maybeSingle();if(a)throw a;return n?{date:r,summaryText:n.summary_text,updatedAt:n.updated_at}:null},async upsertSummary(r,n,a){await t(r);let{data:i,error:s}=await e.from("daily_summaries").upsert({user_id:r,date:n,summary_text:a},{onConflict:"user_id,date"}).select("summary_text, updated_at").single();if(s)throw s;return{date:n,summaryText:i.summary_text,updatedAt:i.updated_at}},async listComments(t,r){let{data:n,error:a}=await e.from("daily_comments").select("character_id, comment_text, generated_at, model").eq("user_id",t).eq("date",r);if(a)throw a;return(n||[]).map(e=>({date:r,characterId:e.character_id,commentText:e.comment_text,generatedAt:e.generated_at,model:e.model}))},async upsertComment(r,n,a,i,s){await t(r);let{data:o,error:c}=await e.from("daily_comments").upsert({user_id:r,date:n,character_id:a,comment_text:i,model:s},{onConflict:"user_id,date,character_id"}).select("character_id, comment_text, generated_at, model").single();if(c)throw c;return{date:n,characterId:o.character_id,commentText:o.comment_text,generatedAt:o.generated_at,model:o.model}},async listEntryCountsByMonth(t,r){let n=new Date(r+"-01"),a=new Date(n);a.setMonth(a.getMonth()+1);let i=n.toISOString().slice(0,10),s=a.toISOString().slice(0,10),{data:o,error:c}=await e.from("diary_entries").select("date").gte("date",i).lt("date",s).eq("user_id",t);if(c)throw c;let u={};for(let e of o||[]){let t=e.date;u[t]=(u[t]||0)+1}return u},async listCharacters(){let{data:t,error:r}=await e.from("characters").select("id, name, code, is_premium, image_url");if(r)throw r;let n=new Map(a.k_.map(e=>[e.id,e]));return(t||[]).map(e=>{let t=n.get(e.id),r=`/characters/${encodeURIComponent(e.name)}.png`,a=`/characters/${e.id}.png`,i=t?.icon?t.icon.replace(".svg",".png"):a,s=e.image_url||r||i;return{id:e.id,name:e.name,code:e.code,premium:!!e.is_premium,icon:s,system:t?.system||""}})}}}(e):{listEntries:async(e,t)=>(0,n.listEntries)(t),addEntry:async(e,t,r)=>(0,n.addEntry)(t,r),getSummary:async(e,t)=>(0,n.getSummary)(t),upsertSummary:async(e,t,r)=>(0,n.upsertSummary)(t,r),listComments:async(e,t)=>(0,n.listComments)(t),upsertComment:async(e,t,r,a,i)=>(0,n.upsertComment)(t,r,a,i),listEntryCountsByMonth:async(e,t)=>(await Promise.resolve().then(r.bind(r,5902))).listEntryCountsByMonth(t),listCharacters:async()=>a.k_.map(e=>({...e,icon:`/characters/${encodeURIComponent(e.name)}.png`}))}}},1472:(e,t,r)=>{r.d(t,{b:()=>i});var n=r(1615),a=r(344);function i(){let e=process.env.SUPABASE_URL,t=process.env.SUPABASE_ANON_KEY;return e&&t?(0,a.createRouteHandlerClient)({cookies:n.cookies}):null}},2131:(e,t,r)=>{r.d(t,{a:()=>i});var n=r(1615),a=r(4770);function i(){let e=(0,n.cookies)(),t=e.get("uid")?.value;if(t)return t;let r=(0,a.randomUUID)();return e.set("uid",r,{httpOnly:!0,path:"/",sameSite:"lax",maxAge:31536e3}),r}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,180],()=>r(779));module.exports=n})();