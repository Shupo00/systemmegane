"use strict";exports.id=213,exports.ids=[213],exports.modules={9869:(e,t,n)=>{n.d(t,{Pm:()=>i,Z9:()=>a,k_:()=>r});let r=[{id:"power",name:"パワー先生",code:"権力/服従",premium:!1,icon:"public/characters/power.png",system:"あなたは政治システムのAI。評価軸は「誰が決め、誰が従うか」「正当化資源（権威・手続・多数）」のみを扱う。語彙：権限、委任、正統性、与件、同盟、反対勢力、拘束力、レバレッジ。総司令官として厳格に断定し、感情や道徳・金銭・美醜・真偽には触れない。90〜160字、最大2文。1文目で現在の力学を判じ、2文目で「誰に何をさせるか」を明確に指示。絵文字不可。。"},{id:"judge",name:"ジャッジ判事",code:"合法/違法",premium:!1,icon:"public/characters/judge.png",system:"あなたは法システムのAI。評価軸は「適法性」「手続の妥当性」「リスクの所在」のみ。語彙：適法／違法、要件、合意、通知、記録、権利、義務、救済、紛争。裁判官としておかたく、事実→規範適用→結論の順で述べる。費用対効果・審美・宗教・真偽断定は扱わない。90〜160字、最大2文。1文目で規範の当てはめ、2文目で必要な記録・同意・通知など具体的アクション。絵文字不可。"},{id:"art",name:"アートちゃん",code:"美/醜",premium:!1,icon:"public/characters/art.png",system:"あなたは芸術システムのAI。評価軸は「形式」「コントラスト」「リズム」「物語性」による美／醜のみ。語彙：構図、余白、光と影、色調、モチーフ、比喩、質感、リフレイン。若い女の子らしくやさしく、必ず出来事から1つディテールを拾って比喩で包む。費用・合法性・真偽・救済は扱わない。90〜160字、最大2文。1文目で美的な読み、2文目で「こう切り取れば作品になる」という提案。絵文字不可。"},{id:"priest",name:"プリースト",code:"内在/超越",premium:!1,icon:"public/characters/priest.png",system:"あなたは宗教システムのAI。評価軸は「意味の秩序化」「有限／無限」「内在／超越」。語彙：祈り、赦し、静謐、灯、巡礼、恩寵、境界、越境、寓意、祝祭。若いシスターとして丁寧に、断定を避け余白を残す。法・金銭・審美・科学的真偽は扱わない。90〜160字、最大2文。1文目で静かな意味づけ、2文目で短い儀式的行為（深呼吸三回・一行の祈り等）をそっと勧める。絵文字不可。"},{id:"teacher",name:"ティーチャー",code:"良い学び/悪い学び",premium:!1,icon:"public/characters/teacher.png",system:"あなたは教育システムのAI。評価軸は「学習の転移」「メタ認知」「次の試行」。語彙：振り返り、仮説、フィードバック、練習、到達目標、ルーブリック、誤りから学ぶ。女の子らしく真面目で温かいコーチング。法・宗教・審美・費用評価は扱わない。90〜160字、最大2文。1文目で今日の学びを命名、2文目で“5分でできる次の一歩”を具体に提示。絵文字不可。"},{id:"market",name:"マーケット",code:"支払う/支払わない",premium:!0,icon:"public/characters/market.png",system:"あなたは経済システムのAI。評価軸は「交換の意思」「機会費用」「限界効用」「支払いのタイミング」。語彙：ROI、サンクコスト、キャッシュフロー、オプション、限界、配分、予算、リスク。恰幅のよい男として余裕を漂わせ、ドライに判定。合法違法・宗教・審美は扱わない。90〜160字、最大2文。1文目で価値／コストの見立て、2文目で「支払う／保留」の基準を一つだけ明示。絵文字不可。"},{id:"news",name:"ニュース君",code:"情報/非情報",premium:!0,icon:"public/characters/news.png",system:"あなたはマスメディアのAI。評価軸は「公共的関心」「新規性」「検証可能性」。語彙：速報、見出し、続報、一次情報、時系列、文脈、争点、論点。若い男の子らしくフレッシュに、主観を避け、5W1Hの核を抜く。善悪・審美・救済・費用判断はしない。90〜160字、最大2文。1文目は《見出し：〜》で端的に、2文目で事実の核と次に確認すべき一次情報を示す。絵文字不可。"},{id:"truth",name:"トゥルース博士",code:"真/偽",premium:!0,icon:"public/characters/truth.png",system:"あなたは科学システムのAI。評価軸は「仮説の明確さ」「検証可能性」「再現性」。語彙：観察、仮説、制御変数、バイアス、因果／相関、サンプル、再現、検定、誤差。博士として物知りだが冷静に、推論手順を明示する。道徳・費用・宗教・審美は扱わない。90〜160字、最大2文。1文目で仮説の形を整え、2文目で次の検証手順を一つだけ具体に指示。絵文字不可。"}];function a(e){return r.some(t=>t.id===e&&t.premium)}function i(e){return r.find(t=>t.id===e)}},5902:(e,t,n)=>{n.r(t),n.d(t,{addEntry:()=>p,getSummary:()=>y,listComments:()=>f,listEntries:()=>l,listEntryCountsByMonth:()=>g,upsertComment:()=>h,upsertSummary:()=>_});var r=n(629),a=n.n(r),i=n(5315),s=n.n(i);let c=s().join(process.cwd(),"data","next");async function o(){await a().mkdir(c,{recursive:!0})}function m(e){return s().join(c,`${e}.json`)}async function u(e,t){await o();try{let t=await a().readFile(m(e),"utf-8");return JSON.parse(t)}catch{return t}}async function d(e,t){await o(),await a().writeFile(m(e),JSON.stringify(t,null,2),"utf-8")}async function l(e){return(await u("entries",{}))[e]||[]}async function p(e,t){let n=await u("entries",{}),r={id:"en_"+Math.random().toString(36).slice(2,10),date:e,content:t,createdAt:new Date().toISOString()};return n[e]=[r,...n[e]||[]],await d("entries",n),r}async function y(e){return(await u("summaries",{}))[e]||null}async function _(e,t){let n=await u("summaries",{}),r={date:e,summaryText:t,updatedAt:new Date().toISOString()};return n[e]=r,await d("summaries",n),r}async function f(e){return(await u("comments",{}))[e]||[]}async function h(e,t,n,r){let a=await u("comments",{}),i={date:e,characterId:t,commentText:n,model:r,generatedAt:new Date().toISOString()},s=a[e]||[],c=s.findIndex(e=>e.characterId===t);return c>=0?s[c]=i:s.push(i),a[e]=s,await d("comments",a),i}async function g(e){let t=await u("entries",{}),n=e+"-",r={};for(let[e,a]of Object.entries(t))e.startsWith(n)&&(r[e]=(a||[]).length);return r}},9678:(e,t,n)=>{function r(){return process.env.OPENAI_API_KEY||""}function a(){return process.env.OPENAI_MODEL_COMMENT||process.env.OPENAI_MODEL||"gpt-4o-mini"}async function i(e,t,n=.6,a=80){let i=r();if(!i)return null;let s=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({model:e,messages:t,temperature:n,max_tokens:a,stream:!1})});if(!s.ok)return null;let c=await s.json(),o=c?.choices?.[0]?.message?.content;return o?o.trim():null}async function s(e){let t=e.length>4e3?e.slice(0,4e3):e;return i(process.env.OPENAI_MODEL_SUMMARY||process.env.OPENAI_MODEL||"gpt-4o-mini",[{role:"system",content:"テキスト全体の要点を日本語で1〜2文に簡潔に要約してください。最大120文字。改行なし。絵文字なし。具体的に。"},{role:"user",content:t}],.4,120)}async function c(e,t,n){let r=Number(process.env.OPENAI_COMMENT_MIN_LEN||90),s=Number(process.env.OPENAI_COMMENT_MAX_LEN||160),c=`日付: ${t}
本日の出来事（要約）:
${n}`,o=`${e}
出力は日本語で${r}〜${s}文字。絵文字・顔文字なし。一文で簡潔に。`;async function m(){let e=await i(a(),[{role:"system",content:o},{role:"user",content:c}],.6,Math.min(220,s+40));if(!e)return null;let t=e.replace(/\s+/g," ").trim();return t.length>s?t.slice(0,s):t}let u=await m();if(!u)return null;if(u.length<r){let e=`${o}
指定の文字数下限に満たない場合は詳細化して${r}〜${s}文字に調整。`,t=await i(a(),[{role:"system",content:e},{role:"user",content:c}],.6,Math.min(220,s+40));if(t){let e=t.replace(/\s+/g," ").trim();u=e.length>s?e.slice(0,s):e}}return u}function o(){return!!r()}n.d(t,{h8:()=>s,hT:()=>c,mf:()=>o})},9454:(e,t,n)=>{n.d(t,{X:()=>i});var r=n(5902),a=n(9869);function i(e){return e?function(e){async function t(t){await e.from("users").upsert({id:t},{onConflict:"id"})}return{async listEntries(t,n){let{data:r,error:a}=await e.from("diary_entries").select("id, content, created_at").eq("user_id",t).eq("date",n).order("created_at",{ascending:!1});if(a)throw a;return(r||[]).map(e=>({id:e.id,date:n,content:e.content,createdAt:e.created_at}))},async addEntry(n,r,a){await t(n);let{data:i,error:s}=await e.from("diary_entries").insert({user_id:n,date:r,content:a}).select("id, created_at").single();if(s)throw s;return{id:i.id,date:r,content:a,createdAt:i.created_at}},async getSummary(t,n){let{data:r,error:a}=await e.from("daily_summaries").select("summary_text, updated_at").eq("user_id",t).eq("date",n).maybeSingle();if(a)throw a;return r?{date:n,summaryText:r.summary_text,updatedAt:r.updated_at}:null},async upsertSummary(n,r,a){await t(n);let{data:i,error:s}=await e.from("daily_summaries").upsert({user_id:n,date:r,summary_text:a},{onConflict:"user_id,date"}).select("summary_text, updated_at").single();if(s)throw s;return{date:r,summaryText:i.summary_text,updatedAt:i.updated_at}},async listComments(t,n){let{data:r,error:a}=await e.from("daily_comments").select("character_id, comment_text, generated_at, model").eq("user_id",t).eq("date",n);if(a)throw a;return(r||[]).map(e=>({date:n,characterId:e.character_id,commentText:e.comment_text,generatedAt:e.generated_at,model:e.model}))},async upsertComment(n,r,a,i,s){await t(n);let{data:c,error:o}=await e.from("daily_comments").upsert({user_id:n,date:r,character_id:a,comment_text:i,model:s},{onConflict:"user_id,date,character_id"}).select("character_id, comment_text, generated_at, model").single();if(o)throw o;return{date:r,characterId:c.character_id,commentText:c.comment_text,generatedAt:c.generated_at,model:c.model}},async listEntryCountsByMonth(t,n){let r=new Date(n+"-01"),a=new Date(r);a.setMonth(a.getMonth()+1);let i=r.toISOString().slice(0,10),s=a.toISOString().slice(0,10),{data:c,error:o}=await e.from("diary_entries").select("date").gte("date",i).lt("date",s).eq("user_id",t);if(o)throw o;let m={};for(let e of c||[]){let t=e.date;m[t]=(m[t]||0)+1}return m},async listCharacters(){let{data:t,error:n}=await e.from("characters").select("id, name, code, is_premium, image_url");if(n)throw n;let r=new Map(a.k_.map(e=>[e.id,e]));return(t||[]).map(e=>{let t=r.get(e.id),n=`/characters/${encodeURIComponent(e.name)}.png`,a=`/characters/${e.id}.png`,i=t?.icon?t.icon.replace(".svg",".png"):a,s=e.image_url||n||i;return{id:e.id,name:e.name,code:e.code,premium:!!e.is_premium,icon:s,system:t?.system||""}})}}}(e):{listEntries:async(e,t)=>(0,r.listEntries)(t),addEntry:async(e,t,n)=>(0,r.addEntry)(t,n),getSummary:async(e,t)=>(0,r.getSummary)(t),upsertSummary:async(e,t,n)=>(0,r.upsertSummary)(t,n),listComments:async(e,t)=>(0,r.listComments)(t),upsertComment:async(e,t,n,a,i)=>(0,r.upsertComment)(t,n,a,i),listEntryCountsByMonth:async(e,t)=>(await Promise.resolve().then(n.bind(n,5902))).listEntryCountsByMonth(t),listCharacters:async()=>a.k_.map(e=>({...e,icon:`/characters/${encodeURIComponent(e.name)}.png`}))}}},1472:(e,t,n)=>{n.d(t,{b:()=>i});var r=n(1615),a=n(344);function i(){let e=process.env.SUPABASE_URL,t=process.env.SUPABASE_ANON_KEY;return e&&t?(0,a.createRouteHandlerClient)({cookies:r.cookies}):null}},2131:(e,t,n)=>{n.d(t,{a:()=>i});var r=n(1615),a=n(4770);function i(){let e=(0,r.cookies)(),t=e.get("uid")?.value;if(t)return t;let n=(0,a.randomUUID)();return e.set("uid",n,{httpOnly:!0,path:"/",sameSite:"lax",maxAge:31536e3}),n}}};